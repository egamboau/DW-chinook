-- insert de las lineas de invoice
SET IDENTITY_INSERT Invoice ON
INSERT INTO Invoice([InvoiceId],[CustomerId],[InvoiceDate],[BillingAddress],[BillingCity],[BillingState],[BillingCountry],[BillingPostalCode],[Total]) VALUES(413,59,'2014-06-01','3,Raj Bhavan Road',' Bangalore','NULL','India','560001','0'),(414,39,'2014-06-27','4, Rue Milton','Paris ','NULL','France','75009','0'),(415,2,'2015-04-10','Theodor-Heuss-Straße 34','Stuttgart ','NULL','Germany','70174','0'),(416,1,'2015-08-10','Av. Brigadeiro Faria Lima, 2170','São José dos Campos ','SP','Brazil','12227-000','0'),(417,52,'2014-11-27','202 Hoxton Street','London ','NULL','United Kingdom','N1 5LH','0'),(418,54,'2015-04-04','110 Raeburn Pl','Edinburgh ','NULL','United Kingdom','EH4 1HH','0'),(419,24,'2014-10-10','162 E Superior Street','Chicago ','IL','USA','60611','0'),(420,30,'2015-06-12','230 Elgin Street','Ottawa ','ON','Canada','K2P 1L7','0'),(421,29,'2015-06-16','796 Dundas Street West','Toronto ','ON','Canada','M6J 1V1','0'),(422,39,'2014-05-08','4, Rue Milton','Paris ','NULL','France','75009','0');
INSERT INTO Invoice([InvoiceId],[CustomerId],[InvoiceDate],[BillingAddress],[BillingCity],[BillingState],[BillingCountry],[BillingPostalCode],[Total]) VALUES(423,48,'2014-01-17','Lijnbaansgracht 120bg','Amsterdam ','VV','Netherlands','1016','0'),(424,43,'2014-09-07','68, Rue Jouvence','Dijon ','NULL','France','21000','0'),(425,49,'2014-09-22','Ordynacka 10','Warsaw ','NULL','Poland','00-358','0'),(426,53,'2014-08-14','113 Lupus St','London ','NULL','United Kingdom','SW1V 3EN','0'),(427,43,'2015-05-17','68, Rue Jouvence','Dijon ','NULL','France','21000','0'),(428,12,'2015-07-24','Praça Pio X, 119','Rio de Janeiro ','RJ','Brazil','20040-020','0'),(429,33,'2015-12-02','5112 48 Street','Yellowknife ','NT','Canada','X1A 1N6','0'),(430,41,'2015-12-26','11, Place Bellecour','Lyon ','NULL','France','69002','0'),(431,20,'2014-10-18','541 Del Medio Avenue','Mountain View ','CA','USA','94040-111','0'),(432,38,'2014-03-08','Barbarossastraße 19','Berlin ','NULL','Germany','10779','0');
INSERT INTO Invoice([InvoiceId],[CustomerId],[InvoiceDate],[BillingAddress],[BillingCity],[BillingState],[BillingCountry],[BillingPostalCode],[Total]) VALUES(433,17,'2014-03-18','1 Microsoft Way','Redmond ','WA','USA','98052-8300','0'),(434,35,'2014-11-16','Rua dos Campeões Europeus de Viena, 4350','Porto ','NULL','Portugal','NULL','0'),(435,7,'2015-06-27','Rotenturmstraße 4, 1010 Innere Stadt','Vienne ','NULL','Austria','1010','0'),(436,35,'2014-05-08','Rua dos Campeões Europeus de Viena, 4350','Porto ','NULL','Portugal','NULL','0'),(437,36,'2015-02-12','Tauentzienstraße 8','Berlin ','NULL','Germany','10789','0'),(438,36,'2014-12-26','Tauentzienstraße 8','Berlin ','NULL','Germany','10789','0'),(439,18,'2015-03-18','627 Broadway','New York ','NY','USA','10012-2612','0'),(440,6,'2014-06-30','Rilská 3174/6','Prague ','NULL','Czech Republic','14300','0'),(441,12,'2015-03-06','Praça Pio X, 119','Rio de Janeiro ','RJ','Brazil','20040-020','0'),(442,54,'2015-08-27','110 Raeburn Pl','Edinburgh ','NULL','United Kingdom','EH4 1HH','0');
INSERT INTO Invoice([InvoiceId],[CustomerId],[InvoiceDate],[BillingAddress],[BillingCity],[BillingState],[BillingCountry],[BillingPostalCode],[Total]) VALUES(443,1,'2015-03-31','Av. Brigadeiro Faria Lima, 2170','São José dos Campos ','SP','Brazil','12227-000','0'),(444,54,'2014-10-13','110 Raeburn Pl','Edinburgh ','NULL','United Kingdom','EH4 1HH','0'),(445,4,'2015-12-12','Ullevålsveien 14','Oslo ','NULL','Norway','0171','0'),(446,52,'2015-09-15','202 Hoxton Street','London ','NULL','United Kingdom','N1 5LH','0'),(447,10,'2015-11-27','Rua Dr. Falcão Filho, 155','São Paulo ','SP','Brazil','01007-010','0'),(448,49,'2014-11-24','Ordynacka 10','Warsaw ','NULL','Poland','00-358','0'),(449,17,'2015-03-03','1 Microsoft Way','Redmond ','WA','USA','98052-8300','0'),(450,21,'2014-06-19','801 W 4th Street','Reno ','NV','USA','89503','0'),(451,1,'2015-11-26','Av. Brigadeiro Faria Lima, 2170','São José dos Campos ','SP','Brazil','12227-000','0'),(452,15,'2015-10-26','700 W Pender Street','Vancouver ','BC','Canada','V6C 1G8','0');
INSERT INTO Invoice([InvoiceId],[CustomerId],[InvoiceDate],[BillingAddress],[BillingCity],[BillingState],[BillingCountry],[BillingPostalCode],[Total]) VALUES(453,6,'2014-08-28','Rilská 3174/6','Prague ','NULL','Czech Republic','14300','0'),(454,2,'2015-12-01','Theodor-Heuss-Straße 34','Stuttgart ','NULL','Germany','70174','0'),(455,29,'2015-07-08','796 Dundas Street West','Toronto ','ON','Canada','M6J 1V1','0'),(456,36,'2015-11-23','Tauentzienstraße 8','Berlin ','NULL','Germany','10789','0'),(457,55,'2014-11-20','421 Bourke Street',' Sidney','NSW','Australia','2010','0'),(458,34,'2014-07-28','Rua da Assunção 53','Lisbon ','NULL','Portugal','NULL','0'),(459,13,'2014-07-29','Qe 7 Bloco G','Brasília ','DF','Brazil','71020-677','0'),(460,24,'2015-05-19','162 E Superior Street','Chicago ','IL','USA','60611','0'),(461,8,'2015-08-14','Grétrystraat 63','Brussels ','NULL','Belgium','1000','0'),(462,38,'2015-06-05','Barbarossastraße 19','Berlin ','NULL','Germany','10779','0');
INSERT INTO Invoice([InvoiceId],[CustomerId],[InvoiceDate],[BillingAddress],[BillingCity],[BillingState],[BillingCountry],[BillingPostalCode],[Total]) VALUES(463,23,'2015-04-05','69 Salem Street','Boston ','MA','USA','2113','0'),(464,24,'2015-09-09','162 E Superior Street','Chicago ','IL','USA','60611','0'),(465,17,'2015-03-30','1 Microsoft Way','Redmond ','WA','USA','98052-8300','0'),(466,30,'2014-02-16','230 Elgin Street','Ottawa ','ON','Canada','K2P 1L7','0'),(467,54,'2014-07-02','110 Raeburn Pl','Edinburgh ','NULL','United Kingdom','EH4 1HH','0'),(468,34,'2015-01-04','Rua da Assunção 53','Lisbon ','NULL','Portugal','NULL','0'),(469,9,'2015-07-12','Sønder Boulevard 51','Copenhagen ','NULL','Denmark','1720','0'),(470,15,'2015-12-23','700 W Pender Street','Vancouver ','BC','Canada','V6C 1G8','0'),(471,38,'2015-10-30','Barbarossastraße 19','Berlin ','NULL','Germany','10779','0'),(472,21,'2015-04-01','801 W 4th Street','Reno ','NV','USA','89503','0');
INSERT INTO Invoice([InvoiceId],[CustomerId],[InvoiceDate],[BillingAddress],[BillingCity],[BillingState],[BillingCountry],[BillingPostalCode],[Total]) VALUES(473,22,'2014-12-07','120 S Orange Ave','Orlando ','FL','USA','32801','0'),(474,9,'2015-03-04','Sønder Boulevard 51','Copenhagen ','NULL','Denmark','1720','0'),(475,53,'2015-04-15','113 Lupus St','London ','NULL','United Kingdom','SW1V 3EN','0'),(476,44,'2015-09-07','Porthaninkatu 9','Helsinki ','NULL','Finland','00530','0'),(477,14,'2014-06-27','8210 111 ST NW','Edmonton ','AB','Canada','T6G 2C7','0'),(478,4,'2014-12-19','Ullevålsveien 14','Oslo ','NULL','Norway','0171','0'),(479,59,'2014-12-07','3,Raj Bhavan Road',' Bangalore','NULL','India','560001','0'),(480,28,'2015-05-11','302 S 700 E','Salt Lake City ','UT','USA','84102','0'),(481,25,'2014-03-13','319 N. Frances Street','Madison ','WI','USA','53703','0'),(482,47,'2015-09-30','Via Degli Scipioni, 43','Rome ','RM','Italy','00192','0');
INSERT INTO Invoice([InvoiceId],[CustomerId],[InvoiceDate],[BillingAddress],[BillingCity],[BillingState],[BillingCountry],[BillingPostalCode],[Total]) VALUES(483,45,'2015-08-17','Erzsébet krt. 58.','Budapest ','NULL','Hungary','H-1073','0'),(484,39,'2015-10-24','4, Rue Milton','Paris ','NULL','France','75009','0'),(485,8,'2014-07-01','Grétrystraat 63','Brussels ','NULL','Belgium','1000','0'),(486,22,'2014-02-04','120 S Orange Ave','Orlando ','FL','USA','32801','0'),(487,29,'2014-06-08','796 Dundas Street West','Toronto ','ON','Canada','M6J 1V1','0'),(488,17,'2014-03-12','1 Microsoft Way','Redmond ','WA','USA','98052-8300','0'),(489,7,'2014-04-14','Rotenturmstraße 4, 1010 Innere Stadt','Vienne ','NULL','Austria','1010','0'),(490,58,'2014-03-02','12,Community Centre',' Delhi','NULL','India','110017','0'),(491,17,'2015-04-20','1 Microsoft Way','Redmond ','WA','USA','98052-8300','0'),(492,3,'2015-10-23','1498 rue Bélanger','Montréal ','QC','Canada','H2G 1A7','0');
INSERT INTO Invoice([InvoiceId],[CustomerId],[InvoiceDate],[BillingAddress],[BillingCity],[BillingState],[BillingCountry],[BillingPostalCode],[Total]) VALUES(493,13,'2015-09-21','Qe 7 Bloco G','Brasília ','DF','Brazil','71020-677','0'),(494,52,'2014-07-21','202 Hoxton Street','London ','NULL','United Kingdom','N1 5LH','0'),(495,25,'2015-07-22','319 N. Frances Street','Madison ','WI','USA','53703','0'),(496,31,'2015-02-03','194A Chain Lake Drive','Halifax ','NS','Canada','B3S 1C5','0'),(497,3,'2014-01-15','1498 rue Bélanger','Montréal ','QC','Canada','H2G 1A7','0'),(498,40,'2015-12-09','8, Rue Hanovre','Paris ','NULL','France','75002','0'),(499,28,'2015-04-01','302 S 700 E','Salt Lake City ','UT','USA','84102','0'),(500,22,'2015-06-16','120 S Orange Ave','Orlando ','FL','USA','32801','0'),(501,17,'2015-08-09','1 Microsoft Way','Redmond ','WA','USA','98052-8300','0'),(502,25,'2015-04-07','319 N. Frances Street','Madison ','WI','USA','53703','0');
INSERT INTO Invoice([InvoiceId],[CustomerId],[InvoiceDate],[BillingAddress],[BillingCity],[BillingState],[BillingCountry],[BillingPostalCode],[Total]) VALUES(503,57,'2015-10-26','Calle Lira, 198',' Santiago','NULL','Chile','NULL','0'),(504,19,'2015-02-13','1 Infinite Loop','Cupertino ','CA','USA','95014','0'),(505,55,'2015-02-08','421 Bourke Street',' Sidney','NSW','Australia','2010','0'),(506,14,'2014-06-14','8210 111 ST NW','Edmonton ','AB','Canada','T6G 2C7','0'),(507,26,'2014-06-19','2211 W Berry Street','Fort Worth ','TX','USA','76110','0'),(508,19,'2015-05-06','1 Infinite Loop','Cupertino ','CA','USA','95014','0'),(509,11,'2014-07-23','Av. Paulista, 2022','São Paulo ','SP','Brazil','01310-200','0'),(510,23,'2014-02-18','69 Salem Street','Boston ','MA','USA','2113','0'),(511,1,'2015-08-28','Av. Brigadeiro Faria Lima, 2170','São José dos Campos ','SP','Brazil','12227-000','0'),(512,18,'2014-06-08','627 Broadway','New York ','NY','USA','10012-2612','0');
SET IDENTITY_INSERT Invoice OFF

--insert de lineas de invoice
SET IDENTITY_INSERT InvoiceLine ON
INSERT INTO InvoiceLine([InvoiceLineId],[InvoiceId],[TrackId],[UnitPrice],[Quantity]) VALUES(2241,471,2983,'0.99','1'),(2242,497,829,'0.99','1'),(2243,485,1820,'0.99','1'),(2244,461,1001,'0.99','1'),(2245,414,3096,'0.99','1'),(2246,431,1650,'0.99','1'),(2247,427,1009,'0.99','1'),(2248,443,624,'0.99','1'),(2249,468,3098,'0.99','1'),(2250,422,1450,'0.99','1');
INSERT INTO InvoiceLine([InvoiceLineId],[InvoiceId],[TrackId],[UnitPrice],[Quantity]) VALUES(2251,455,336,'0.99','1'),(2252,419,272,'0.99','1'),(2253,441,3373,'0.99','1'),(2254,415,2557,'0.99','1'),(2255,467,1378,'0.99','1'),(2256,456,792,'0.99','1'),(2257,501,406,'0.99','1'),(2258,480,1200,'0.99','1'),(2259,416,2585,'0.99','1'),(2260,498,2030,'0.99','1');
INSERT INTO InvoiceLine([InvoiceLineId],[InvoiceId],[TrackId],[UnitPrice],[Quantity]) VALUES(2261,443,440,'0.99','1'),(2262,459,3165,'1.99','1'),(2263,424,2688,'0.99','1'),(2264,446,1982,'0.99','1'),(2265,464,974,'0.99','1'),(2266,488,899,'0.99','1'),(2267,437,416,'0.99','1'),(2268,451,9,'0.99','1'),(2269,452,1979,'0.99','1'),(2270,465,866,'0.99','1');
INSERT INTO InvoiceLine([InvoiceLineId],[InvoiceId],[TrackId],[UnitPrice],[Quantity]) VALUES(2271,511,2749,'0.99','1'),(2272,439,2437,'0.99','1'),(2273,467,1662,'0.99','1'),(2274,494,2731,'0.99','1'),(2275,467,79,'0.99','1'),(2276,419,3156,'0.99','1'),(2277,454,121,'0.99','1'),(2278,471,602,'0.99','1'),(2279,475,1921,'0.99','1'),(2280,434,2385,'0.99','1');
INSERT INTO InvoiceLine([InvoiceLineId],[InvoiceId],[TrackId],[UnitPrice],[Quantity]) VALUES(2281,475,1425,'0.99','1'),(2282,471,3044,'0.99','1'),(2283,467,2382,'0.99','1'),(2284,453,997,'0.99','1'),(2285,421,985,'0.99','1'),(2286,452,218,'0.99','1'),(2287,497,2592,'0.99','1'),(2288,506,2670,'0.99','1'),(2289,494,3390,'0.99','1'),(2290,474,414,'0.99','1');
INSERT INTO InvoiceLine([InvoiceLineId],[InvoiceId],[TrackId],[UnitPrice],[Quantity]) VALUES(2291,503,1941,'0.99','1'),(2292,474,1803,'0.99','1'),(2293,421,2363,'0.99','1'),(2294,443,744,'0.99','1'),(2295,503,87,'0.99','1'),(2296,491,1600,'0.99','1'),(2297,427,2399,'0.99','1'),(2298,479,1908,'0.99','1'),(2299,467,2696,'0.99','1'),(2300,430,1282,'0.99','1');
INSERT INTO InvoiceLine([InvoiceLineId],[InvoiceId],[TrackId],[UnitPrice],[Quantity]) VALUES(2301,464,1255,'0.99','1'),(2302,462,2854,'1.99','1'),(2303,473,1207,'0.99','1'),(2304,453,3323,'0.99','1'),(2305,503,2714,'0.99','1'),(2306,512,503,'0.99','1'),(2307,496,527,'0.99','1'),(2308,505,2269,'0.99','1'),(2309,465,3057,'0.99','1'),(2310,450,1532,'0.99','1');
INSERT INTO InvoiceLine([InvoiceLineId],[InvoiceId],[TrackId],[UnitPrice],[Quantity]) VALUES(2311,426,2685,'0.99','1'),(2312,496,1755,'0.99','1'),(2313,467,3008,'0.99','1'),(2314,476,586,'0.99','1'),(2315,416,977,'0.99','1'),(2316,446,2898,'1.99','1'),(2317,480,3351,'0.99','1'),(2318,421,1332,'0.99','1'),(2319,483,3313,'0.99','1'),(2320,468,1804,'0.99','1');
INSERT INTO InvoiceLine([InvoiceLineId],[InvoiceId],[TrackId],[UnitPrice],[Quantity]) VALUES(2321,453,3494,'0.99','1'),(2322,448,3249,'1.99','1'),(2323,417,857,'0.99','1'),(2324,416,488,'0.99','1'),(2325,441,1536,'0.99','1'),(2326,465,371,'0.99','1'),(2327,432,302,'0.99','1'),(2328,485,2592,'0.99','1'),(2329,486,2240,'0.99','1'),(2330,458,671,'0.99','1');
INSERT INTO InvoiceLine([InvoiceLineId],[InvoiceId],[TrackId],[UnitPrice],[Quantity]) VALUES(2331,424,2309,'0.99','1'),(2332,450,451,'0.99','1'),(2333,490,2435,'0.99','1'),(2334,503,2985,'0.99','1'),(2335,472,1556,'0.99','1'),(2336,457,1324,'0.99','1'),(2337,456,1323,'0.99','1'),(2338,434,2769,'0.99','1'),(2339,495,458,'0.99','1'),(2340,428,3441,'0.99','1');
SET IDENTITY_INSERT InvoiceLine OFF

-- algunas invoices no tienen lineas, las eliminamos
DELETE I
FROM Invoice I LEFT JOIN InvoiceLine IL
	ON IL.InvoiceId = I.InvoiceId
WHERE IL.InvoiceId IS NULL


--actualizar los totales de las invoices!
UPDATE Invoice
SET Total = (SELECT SUM([UnitPrice] * [Quantity])
 FROM [Chinook].[dbo].[InvoiceLine]
 WHERE Invoice.InvoiceId = InvoiceLine.InvoiceId
 GROUP BY [InvoiceId])
WHERE EXISTS(select * from InvoiceLine IL where IL.InvoiceId = Invoice.InvoiceId)


SELECT Invoice.InvoiceId, InvoiceLine.InvoiceId, Invoice.Total
FROM Invoice LEFT JOIN InvoiceLine 
	ON Invoice.InvoiceId = InvoiceLine.InvoiceId


